clear all;
clc;

rng(3);

X = zeros(5,5,5) ;

X(:,:,1) = [ 0 1 1 0 0 ;
             0 0 1 0 0 ;
             0 0 1 0 0 ;
             0 0 1 0 0 ;
             0 1 1 1 0 
             ];

X(:,:,2) = [ 1 1 1 1 0 ;
             0 0 0 0 1 ;
             0 1 1 1 1 ;
             1 0 0 0 0 ;
             0 1 1 1 1 
             ];
         
X(:,:,3) = [ 1 1 1 1 0 ;
             0 0 0 0 1 ;
             0 1 1 1 0 ;
             0 0 0 0 1 ;
             1 1 1 1 0 
             ];
         
X(:,:,4) = [ 0 0 0 1 0 ;
             0 0 1 1 0 ;
             0 1 0 1 0 ;
             1 1 1 1 1 ;
             0 0 0 1 0 
             ];

X(:,:,5) = [ 1 1 1 1 0 ;
             1 0 0 0 0 ;
             1 1 1 1 0 ;
             0 0 0 0 1 ;
             1 1 1 1 0 
             ];

D = [ 1 0 0 0 0;
      0 1 0 0 0 ;
      0 0 1 0 0 ;
      0 0 0 1 0 ;
      0 0 0 0 1 
      ];
         
W1 = 2*rand(20, 25) -1;
W2 = 2*rand(20, 20) -1;
W3 = 2*rand(20, 20) -1;
W4 = 2*rand( 5, 20) -1;
%W5 = 2*rand( 5, 5) -1;

W = {W1,W2,W3,W4} ;
for epoch = 1:2000
    W = DeepReLUfor(W,X,D);
end


N = 5 ;

for k = 1:N
    x = reshape(X(:,:,k),25,1);
    for i = 1:length(W) 
        v = cell2mat(W(i))*x;
        x = ReLU(v);
    end
    y = Softmax(x) ;
end

